<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <t t-name="taphoa_management.LoyaltyPopup" owl="1">
        <div class="popup loyalty-popup">
            <header class="popup-header">
                <h3 class="title"><t t-esc="props.title"/></h3>
            </header>
            
            <main class="popup-body loyalty-popup-body">
                <!-- Th√¥ng tin ƒëi·ªÉm hi·ªán t·∫°i -->
                <div class="loyalty-info-section">
                    <div class="loyalty-info-row">
                        <strong>ƒêi·ªÉm hi·ªán t·∫°i:</strong>
                        <span class="loyalty-points-current">
                            <t t-esc="currentPoints"/> ƒëi·ªÉm
                        </span>
                    </div>
                    
                    <div class="loyalty-info-row">
                        <strong>T·ªïng ƒë∆°n h√†ng:</strong>
                        <span class="loyalty-order-total">
                            <t t-esc="orderTotal.toLocaleString('vi-VN')"/> ƒë
                        </span>
                    </div>
                    
                    <div class="loyalty-info-row highlight">
                        <strong>ƒêi·ªÉm s·∫Ω t√≠ch:</strong>
                        <span class="loyalty-points-earn" style="color: #28a745; font-weight: bold;">
                            +<t t-esc="pointsToEarn"/> ƒëi·ªÉm
                        </span>
                    </div>
                    
                    <div class="loyalty-explanation" style="color: #6c757d; margin-top: 10px; font-size: 0.9em; border-top: 1px solid #ddd; padding-top: 10px; margin-bottom: 15px;">
                        <em><t t-esc="explanation"/></em>
                    </div>
                </div>
                
                <!-- ƒê·ªïi ƒëi·ªÉm section -->
                <div class="loyalty-redeem-section" style="border-top: 2px solid #007bff; padding-top: 15px; margin-top: 15px;">
                    <h4 style="color: #007bff; margin-bottom: 10px;">üéÅ ƒê·ªïi ƒëi·ªÉm l·∫•y gi·∫£m gi√°</h4>
                    
                    <div class="loyalty-info-row" style="margin-bottom: 10px;">
                        <span style="font-size: 0.9em; color: #6c757d;">
                            100 ƒëi·ªÉm = 1,000ƒë gi·∫£m gi√°
                        </span>
                    </div>
                    
                    <div class="loyalty-redeem-input-group" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <label style="min-width: 100px;">S·ªë ƒëi·ªÉm ƒë·ªïi:</label>
                        <input 
                            type="number" 
                            class="form-control" 
                            style="flex: 1; padding: 8px;"
                            t-model="state.redeemPoints"
                            t-on-input="onRedeemPointsChange"
                            step="100"
                            min="0"
                            t-att-max="maxRedeemPoints"
                            placeholder="0"
                        />
                        <span style="min-width: 80px; color: #6c757d;">
                            (Max: <t t-esc="maxRedeemPoints"/>)
                        </span>
                    </div>
                    
                    <div class="loyalty-info-row" style="background: #e7f3ff; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
                        <strong>Gi·∫£m gi√°:</strong>
                        <span style="color: #dc3545; font-weight: bold; font-size: 1.1em;">
                            -<t t-esc="state.discountAmount.toLocaleString('vi-VN')"/> ƒë
                        </span>
                    </div>
                    
                    <div class="loyalty-info-row" style="background: #fff3cd; padding: 10px; border-radius: 5px;">
                        <strong>T·ªïng ti·ªÅn sau gi·∫£m:</strong>
                        <span style="color: #856404; font-weight: bold; font-size: 1.1em;">
                            <t t-esc="finalOrderTotal.toLocaleString('vi-VN')"/> ƒë
                        </span>
                    </div>
                </div>
                
                <!-- T·ªïng k·∫øt ƒëi·ªÉm sau giao d·ªãch -->
                <div class="loyalty-summary-section" style="border-top: 1px solid #ddd; padding-top: 15px; margin-top: 15px;">
                    <div class="loyalty-info-row total" style="background: #d4edda; padding: 12px; border-radius: 5px;">
                        <strong>ƒêi·ªÉm cu·ªëi c√πng:</strong>
                        <span class="loyalty-points-final" style="color: #155724; font-weight: bold; font-size: 1.2em;">
                            <t t-esc="pointsAfterRedeem"/> ƒëi·ªÉm
                        </span>
                    </div>
                    <div style="font-size: 0.85em; color: #6c757d; margin-top: 8px; text-align: center;">
                        = <t t-esc="currentPoints"/> (hi·ªán t·∫°i) - <t t-esc="state.redeemPoints"/> (ƒë·ªïi) + <t t-esc="pointsToEarn"/> (t√≠ch m·ªõi)
                    </div>
                </div>
            </main>
            
            <footer class="popup-footer">
                <button class="btn btn-primary confirm" t-on-click="confirm">
                    <t t-if="state.redeemPoints > 0">√Åp d·ª•ng gi·∫£m gi√°</t>
                    <t t-else=""><t t-esc="props.confirmText || 'OK'"/></t>
                </button>
                <button class="btn btn-secondary cancel" t-on-click="cancel">
                    <t t-esc="props.cancelText || 'ƒê√≥ng'"/>
                </button>
            </footer>
        </div>
    </t>

</templates>
