# HÆ°á»›ng dáº«n Sá»­ dá»¥ng TÃ­ch Ä‘iá»ƒm táº¡i POS

## Cáº¥u hÃ¬nh ban Ä‘áº§u

### 1. Táº¡o sáº£n pháº©m giáº£m giÃ¡ (Ä‘Ã£ cÃ³ sáºµn)
Module Ä‘Ã£ tá»± Ä‘á»™ng táº¡o sáº£n pháº©m "Giáº£m giÃ¡ tá»« Ä‘iá»ƒm tÃ­ch lÅ©y" vá»›i mÃ£ `LOYALTY_DISCOUNT`.

### 2. Cáº¥u hÃ¬nh POS
1. VÃ o **Point of Sale > Configuration > Point of Sale**
2. Chá»n POS cá»§a báº¡n
3. Trong tab cáº¥u hÃ¬nh, tÃ¬m pháº§n **"TÃ­ch Ä‘iá»ƒm khÃ¡ch hÃ ng"**
4. Báº­t **"KÃ­ch hoáº¡t tÃ­ch Ä‘iá»ƒm"**
5. Chá»n **"Sáº£n pháº©m giáº£m giÃ¡ tá»« Ä‘iá»ƒm"** = `Giáº£m giÃ¡ tá»« Ä‘iá»ƒm tÃ­ch lÅ©y`
6. LÆ°u cáº¥u hÃ¬nh

### 3. Táº¡o tháº» tÃ­ch Ä‘iá»ƒm cho khÃ¡ch hÃ ng
1. VÃ o **TÃ­ch Ä‘iá»ƒm > Tháº» tÃ­ch Ä‘iá»ƒm**
2. Click **Táº¡o**
3. Chá»n khÃ¡ch hÃ ng
4. Chá»n chÆ°Æ¡ng trÃ¬nh (ThÃ¢n thiáº¿t hoáº·c VIP)
5. LÆ°u

---

## Sá»­ dá»¥ng táº¡i POS

### Giao diá»‡n POS vá»›i TÃ­ch Ä‘iá»ƒm

Khi má»Ÿ POS, báº¡n sáº½ tháº¥y:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Sáº£n pháº©m]     [Giá» hÃ ng]  [TÃ­ch Ä‘iá»ƒm] â”‚
â”‚                                          â”‚
â”‚  â€¢ Chá»n khÃ¡ch hÃ ng                       â”‚
â”‚  â€¢ Widget tÃ­ch Ä‘iá»ƒm tá»± Ä‘á»™ng hiá»ƒn thá»‹     â”‚
â”‚    - Tháº» sá»‘: LC00000001                  â”‚
â”‚    - Äiá»ƒm hiá»‡n táº¡i: 50                   â”‚
â”‚    - Button "Äá»•i Ä‘iá»ƒm"                   â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Quy trÃ¬nh bÃ¡n hÃ ng cÃ³ tÃ­ch Ä‘iá»ƒm

#### BÆ°á»›c 1: Chá»n khÃ¡ch hÃ ng
1. Click vÃ o nÃºt **"KhÃ¡ch hÃ ng"** á»Ÿ gÃ³c trÃªn
2. Chá»n khÃ¡ch hÃ ng tá»« danh sÃ¡ch
3. **Widget tÃ­ch Ä‘iá»ƒm** sáº½ tá»± Ä‘á»™ng hiá»ƒn thá»‹ (náº¿u khÃ¡ch cÃ³ tháº»)

#### BÆ°á»›c 2: ThÃªm sáº£n pháº©m vÃ o giá»
- ThÃªm sáº£n pháº©m nhÆ° bÃ¬nh thÆ°á»ng
- Widget tÃ­ch Ä‘iá»ƒm sáº½ cáº­p nháº­t:
  - **Äiá»ƒm tÃ­ch Ä‘Æ°á»£c**: Tá»± Ä‘á»™ng tÃ­nh dá»±a trÃªn tá»•ng Ä‘Æ¡n hÃ ng

#### BÆ°á»›c 3: Äá»•i Ä‘iá»ƒm (náº¿u muá»‘n)
1. Click nÃºt **"Äá»•i Ä‘iá»ƒm"** trÃªn widget tÃ­ch Ä‘iá»ƒm
2. Popup hiá»ƒn thá»‹:
   ```
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Use Loyalty Points               â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚  KhÃ¡ch hÃ ng: Nguyá»…n VÄƒn A         â”‚
   â”‚  Sá»‘ tháº»: LC00000001               â”‚
   â”‚  Äiá»ƒm hiá»‡n cÃ³: 50                 â”‚
   â”‚  ChÆ°Æ¡ng trÃ¬nh: KhÃ¡ch hÃ ng thÃ¢n thiáº¿t â”‚
   â”‚  1 Ä‘iá»ƒm = 1,000Ä‘                  â”‚
   â”‚  Tá»‘i thiá»ƒu: 10 Ä‘iá»ƒm               â”‚
   â”‚  Giáº£m tá»‘i Ä‘a: 50%                 â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚  Sá»‘ Ä‘iá»ƒm muá»‘n sá»­ dá»¥ng:            â”‚
   â”‚  [______30______] [DÃ¹ng tá»‘i Ä‘a]   â”‚
   â”‚                                   â”‚
   â”‚  Giáº£m giÃ¡: 30,000Ä‘                â”‚
   â”‚  Äiá»ƒm cÃ²n láº¡i: 20                 â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚  [Cancel]          [Apply]        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   ```

3. Nháº­p sá»‘ Ä‘iá»ƒm muá»‘n dÃ¹ng hoáº·c click **"DÃ¹ng tá»‘i Ä‘a"**
4. Click **"Apply"**

#### BÆ°á»›c 4: Xem thÃ´ng tin cáº­p nháº­t
Widget tÃ­ch Ä‘iá»ƒm sáº½ hiá»ƒn thá»‹:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â­ TÃ­ch Ä‘iá»ƒm             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tháº»: LC00000001         â”‚
â”‚ Äiá»ƒm hiá»‡n táº¡i: 50       â”‚
â”‚ Äiá»ƒm sá»­ dá»¥ng: -30       â”‚
â”‚ Giáº£m giÃ¡: -30,000Ä‘      â”‚
â”‚ Äiá»ƒm tÃ­ch Ä‘Æ°á»£c: +14     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ Äiá»ƒm sau GD: 34         â”‚
â”‚                         â”‚
â”‚ [ğŸ Äá»•i Ä‘iá»ƒm]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Giá» hÃ ng sáº½ cÃ³ dÃ²ng:
- **Giáº£m giÃ¡ tá»« Ä‘iá»ƒm tÃ­ch lÅ©y**: -30,000Ä‘

#### BÆ°á»›c 5: Thanh toÃ¡n
1. Click **"Thanh toÃ¡n"**
2. Chá»n phÆ°Æ¡ng thá»©c thanh toÃ¡n
3. XÃ¡c nháº­n thanh toÃ¡n
4. **Há»‡ thá»‘ng tá»± Ä‘á»™ng**:
   - Trá»« 30 Ä‘iá»ƒm tá»« tháº»
   - TÃ­ch 14 Ä‘iá»ƒm má»›i (tá»« sá»‘ tiá»n sau giáº£m giÃ¡)
   - Táº¡o 2 giao dá»‹ch tÃ­ch Ä‘iá»ƒm

---

## TÃ­nh toÃ¡n chi tiáº¿t

### VÃ­ dá»¥: ÄÆ¡n hÃ ng 200,000Ä‘

**TrÆ°á»›c khi dÃ¹ng Ä‘iá»ƒm:**
- Tá»•ng Ä‘Æ¡n: 200,000Ä‘
- KhÃ¡ch cÃ³: 50 Ä‘iá»ƒm

**KhÃ¡ch dÃ¹ng 30 Ä‘iá»ƒm:**
- Giáº£m giÃ¡: 30 Ä‘iá»ƒm Ã— 1,000Ä‘ = **30,000Ä‘**
- Pháº£i tráº£: 200,000Ä‘ - 30,000Ä‘ = **170,000Ä‘**

**Sau thanh toÃ¡n:**
- Trá»« Ä‘iá»ƒm: -30
- TÃ­ch Ä‘iá»ƒm má»›i: 170,000Ä‘ Ã· 10,000Ä‘ = +17
- **Tá»•ng Ä‘iá»ƒm cÃ²n**: 50 - 30 + 17 = **37 Ä‘iá»ƒm**

### Giá»›i háº¡n giáº£m giÃ¡ tá»‘i Ä‘a

ChÆ°Æ¡ng trÃ¬nh "ThÃ¢n thiáº¿t" giá»›i háº¡n 50%:
- ÄÆ¡n 100,000Ä‘ â†’ Giáº£m tá»‘i Ä‘a 50,000Ä‘
- Náº¿u dÃ¹ng 100 Ä‘iá»ƒm (= 100,000Ä‘) â†’ Chá»‰ giáº£m 50,000Ä‘

**VÃ­ dá»¥:**
```
ÄÆ¡n hÃ ng: 100,000Ä‘
KhÃ¡ch cÃ³: 100 Ä‘iá»ƒm
DÃ¹ng: 100 Ä‘iá»ƒm

âŒ KHÃ”NG giáº£m 100,000Ä‘ (100%)
âœ… CHá»ˆ giáº£m 50,000Ä‘ (50%)

Pháº£i tráº£: 50,000Ä‘
TÃ­ch Ä‘Æ°á»£c: 5 Ä‘iá»ƒm (tá»« 50,000Ä‘)
Äiá»ƒm sau: 100 - 100 + 5 = 5 Ä‘iá»ƒm
```

---

## Xem bÃ¡o cÃ¡o

### 1. Lá»‹ch sá»­ giao dá»‹ch cá»§a khÃ¡ch hÃ ng
- VÃ o **LiÃªn há»‡ > KhÃ¡ch hÃ ng**
- Chá»n khÃ¡ch hÃ ng
- Tab **"TÃ­ch Ä‘iá»ƒm"**
- Click vÃ o tháº» â†’ Button **"Xem giao dá»‹ch"**

### 2. Táº¥t cáº£ giao dá»‹ch
- VÃ o **TÃ­ch Ä‘iá»ƒm > Giao dá»‹ch**
- Lá»c theo:
  - HÃ´m nay / Tuáº§n nÃ y / ThÃ¡ng nÃ y
  - TÃ­ch Ä‘iá»ƒm / Äá»•i Ä‘iá»ƒm
  - KhÃ¡ch hÃ ng
  - POS Order

### 3. Thá»‘ng kÃª Ä‘Æ¡n hÃ ng POS
- VÃ o **Point of Sale > Orders > Orders**
- Xem cÃ¡c trÆ°á»ng:
  - **Äiá»ƒm tÃ­ch Ä‘Æ°á»£c**
  - **Äiá»ƒm Ä‘Ã£ sá»­ dá»¥ng**
  - **Giáº£m giÃ¡ tá»« Ä‘iá»ƒm**

---

## Xá»­ lÃ½ tÃ¬nh huá»‘ng

### KhÃ¡ch hÃ ng khÃ´ng cÃ³ tháº»
â†’ Widget tÃ­ch Ä‘iá»ƒm khÃ´ng hiá»ƒn thá»‹
â†’ Táº¡o tháº» tá»« backend trÆ°á»›c

### KhÃ¡ch muá»‘n há»§y viá»‡c dÃ¹ng Ä‘iá»ƒm
1. Click láº¡i nÃºt **"Äá»•i Ä‘iá»ƒm"**
2. Nháº­p 0 Ä‘iá»ƒm
3. Apply
â†’ DÃ²ng giáº£m giÃ¡ sáº½ bá»‹ xÃ³a

### Thay Ä‘á»•i giá» hÃ ng sau khi Ä‘Ã£ dÃ¹ng Ä‘iá»ƒm
- Widget tá»± Ä‘á»™ng cáº­p nháº­t Ä‘iá»ƒm tÃ­ch Ä‘Æ°á»£c
- Giáº£m giÃ¡ tá»« Ä‘iá»ƒm **khÃ´ng tá»± Ä‘á»™ng thay Ä‘á»•i**
- Cáº§n click láº¡i **"Äá»•i Ä‘iá»ƒm"** Ä‘á»ƒ Ä‘iá»u chá»‰nh

### KhÃ¡ch há»§y Ä‘Æ¡n
- Giao dá»‹ch chá»‰ Ä‘Æ°á»£c táº¡o **sau khi thanh toÃ¡n**
- Náº¿u há»§y trÆ°á»›c thanh toÃ¡n â†’ KhÃ´ng áº£nh hÆ°á»Ÿng gÃ¬

---

## LÆ°u Ã½ quan trá»ng

### 1. Chá»n Ä‘Ãºng sáº£n pháº©m giáº£m giÃ¡
- Pháº£i cáº¥u hÃ¬nh trong POS Config
- Sáº£n pháº©m pháº£i cÃ³ `available_in_pos = True`
- KhÃ´ng Ä‘Æ°á»£c Ä‘Ã¡nh thuáº¿

### 2. Quyá»n truy cáº­p
- Thu ngÃ¢n cÃ³ thá»ƒ xem vÃ  dÃ¹ng Ä‘iá»ƒm
- KhÃ´ng thá»ƒ sá»­a Ä‘iá»ƒm thá»§ cÃ´ng
- Chá»‰ Manager má»›i Ä‘iá»u chá»‰nh Ä‘Æ°á»£c

### 3. Performance
- Widget load thÃ´ng tin khi chá»n khÃ¡ch hÃ ng
- CÃ³ thá»ƒ hÆ¡i cháº­m náº¿u khÃ¡ch cÃ³ nhiá»u giao dá»‹ch
- CÃ¢n nháº¯c archiving old transactions

### 4. Offline mode
- POS Odoo há»— trá»£ offline
- TÃ­nh nÄƒng tÃ­ch Ä‘iá»ƒm cáº§n káº¿t ná»‘i server
- KhÃ´ng thá»ƒ dÃ¹ng Ä‘iá»ƒm khi offline

---

## Troubleshooting

### Widget khÃ´ng hiá»ƒn thá»‹?
âœ“ Kiá»ƒm tra khÃ¡ch hÃ ng cÃ³ tháº» khÃ´ng
âœ“ Tháº» pháº£i á»Ÿ tráº¡ng thÃ¡i "active"
âœ“ ÄÃ£ báº­t "KÃ­ch hoáº¡t tÃ­ch Ä‘iá»ƒm" trong POS Config
âœ“ Clear cache trÃ¬nh duyá»‡t

### KhÃ´ng click Ä‘Æ°á»£c "Äá»•i Ä‘iá»ƒm"?
âœ“ KhÃ¡ch cÃ³ Ã­t nháº¥t min_points_to_redeem
âœ“ ÄÆ¡n hÃ ng pháº£i cÃ³ sáº£n pháº©m
âœ“ Check console browser cÃ³ lá»—i JS khÃ´ng

### Äiá»ƒm khÃ´ng Ä‘Æ°á»£c tÃ­ch?
âœ“ ÄÆ¡n hÃ ng pháº£i thanh toÃ¡n xong
âœ“ GiÃ¡ trá»‹ Ä‘Æ¡n â‰¥ min_order_amount
âœ“ Check log server Odoo

### Giáº£m giÃ¡ khÃ´ng Ä‘Ãºng?
âœ“ Kiá»ƒm tra max_discount_percentage
âœ“ Kiá»ƒm tra points_to_discount_rate
âœ“ TÃ­nh toÃ¡n láº¡i thá»§ cÃ´ng Ä‘á»ƒ verify

---

## FAQ

**Q: CÃ³ thá»ƒ dÃ¹ng Ä‘iá»ƒm tá»« nhiá»u tháº»?**  
A: KhÃ´ng, má»—i Ä‘Æ¡n chá»‰ dÃ¹ng 1 tháº» (cá»§a khÃ¡ch hÃ ng Ä‘Æ°á»£c chá»n).

**Q: KhÃ¡ch cÃ³ thá»ƒ tÃ­ch Ä‘iá»ƒm tá»« pháº§n giáº£m giÃ¡ khÃ´ng?**  
A: KhÃ´ng, chá»‰ tÃ­ch Ä‘iá»ƒm trÃªn sá»‘ tiá»n thá»±c táº¿ pháº£i tráº£.

**Q: Äiá»ƒm cÃ³ háº¿t háº¡n khÃ´ng?**  
A: CÃ³, theo cáº¥u hÃ¬nh `points_expiry_days` (máº·c Ä‘á»‹nh 365 ngÃ y).

**Q: CÃ³ thá»ƒ chuyá»ƒn Ä‘iá»ƒm giá»¯a cÃ¡c khÃ¡ch hÃ ng?**  
A: KhÃ´ng, Ä‘iá»ƒm gáº¯n vá»›i tá»«ng tháº» riÃªng biá»‡t.

**Q: LÃ m sao táº¡o tháº» hÃ ng loáº¡t?**  
A: DÃ¹ng import CSV hoáº·c viáº¿t script Python.

---

**TÃ i liá»‡u chi tiáº¿t**: Xem `LOYALTY_GUIDE.md`  
**Há»— trá»£ ká»¹ thuáº­t**: LiÃªn há»‡ admin há»‡ thá»‘ng
